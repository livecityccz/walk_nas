# 目录遍历工具

用于连接如NAS服务器并递归遍历其目录结构，将结果保存到本地文件中。

## 功能特性

- 📁 递归遍历指定目录，获取完整的文件结构
- ⚙️ 可配置的扫描深度和参数
- 🛡️ 完善的错误处理和权限检查
- 📝 详细的日志记录

## 系统要求

- Python 3.7+
- Windows/Linux/macOS
- 网络连接到NAS服务器

## 安装步骤

1. **克隆或下载项目文件**
   ```bash
   git clone <repository-url>
   cd walk_nas
   ```

2. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

3. **配置NAS连接信息**
   - 编辑 `config.ini` 文件
   - 修改 `[NAS_SERVER]` 部分的IP地址、用户名和密码
   - 根据需要调整其他参数

## 配置说明

### config.ini 文件结构

```ini
[NAS_SERVER]
# NAS服务器IP地址
ip = 192.168.1.XX
# 用户名
username = 用户名
# 密码
password = 密码
[CONNECTION]
# 连接协议 (目前支持ssh)
protocol = ssh
# SSH端口号
port = 8224
# 连接超时时间(秒)
timeout = 30

[SCAN]
# 要扫描的根目录路径
root_path = 扫描绝对路径
# 最大扫描深度
max_depth = 10
# 是否包含隐藏文件
include_hidden = false
# 输出格式 (json, txt 或 md)
output_format = md
# 输出文件名
output_file = nas_structure.md
```

## 使用方法

### 基本使用

```bash
python nas_walker.py
```

### 程序执行流程

1. 程序启动后会自动检查配置文件
2. 如果配置文件不存在，会创建默认配置
3. 尝试连接到NAS服务器
4. 开始递归扫描指定目录
5. 将结果保存到指定文件
6. 生成详细的日志文件

## 错误处理

程序包含以下错误处理机制：

- **连接失败**: 网络问题、认证失败等
- **权限不足**: 访问受限的目录或文件
- **超时处理**: 网络延迟或服务器响应慢
- **日志记录**: 所有操作和错误都会记录到 `nas_walker.log`

## 常见问题

### Q: 连接失败怎么办？
A: 检查以下项目：
- NAS服务器IP地址是否正确
- 用户名和密码是否正确
- 网络连接是否正常
- 防火墙设置是否允许SMB连接

### Q: 扫描速度很慢？
A: 可以尝试：
- 减少 `max_depth` 值
- 增加 `timeout` 值
- 检查网络带宽

### Q: 某些目录无法访问？
A: 这通常是权限问题：
- 检查用户权限设置
- 确认共享文件夹的访问权限
- 查看日志文件中的具体错误信息

## 日志文件

程序运行时会生成 `nas_walker.log` 文件，包含：
- 连接状态信息
- 扫描进度
- 错误详情
- 操作时间戳

## 安全注意事项

- 不要在代码中硬编码密码
- 定期更新NAS服务器的安全补丁
- 使用强密码和适当的用户权限
- 考虑使用VPN连接以提高安全性